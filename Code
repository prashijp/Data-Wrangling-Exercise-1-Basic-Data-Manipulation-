

data_dir <- "https://github.com/prashijp/Data-Wrangling-Exercise-1-Basic-Data-Manipulation-"
compdata <- read.csv(file.path(data_dir,"refine_original.csv"),header = TRUE)

compdata$company <- tolower(compdata$company)
compdata$company <- gsub("ph.*","philips",compdata$company)
compdata$company <- gsub("ak.*","akzo",compdata$company)
compdata$company <- gsub("f.*","philips",compdata$company)
compdata$company <- gsub("un.*","unilever",compdata$company)
compdata$company <- gsub("va.*","van houten",compdata$company)


#View the columns 
colnames(compdata)

# Separate product code and number 
newcompdata <- separate(data = compdata, col = Product.code...number, into = c("product_code", "product_number"), sep = "-") 


# Add product categories
compfunction <- function(x){switch(x, p = "Smartphone",v = "TV", x= "Laptop", q = "Tablet")}

pickproduct <- function(x){ifelse(x == 'p', 'Smartphone', ifelse(x=='v','TV',ifelse(x=='x','Laptop',ifelse(x == 'q','Tablet',NA))))}

# Add full address for geocoding & Create dummy variables for company and product category
newcompdata <- newcompdata %>% 
+ mutate(product_category = pickproduct(product_code), full_address = paste(address, city, country, sep=", "),company_philips = ifelse(company == 'phillips', 1, 0),company_akzo = ifelse(company == 'akzo', 1, 0),company_van_houten = ifelse(company == 'van houten', 1, 0),company_unilever = ifelse(company == 'unilever', 1, 0),product_smartphone = ifelse(product_code == 'p', 1, 0),product_tv = ifelse(product_code == 'v', 1, 0),product_laptop = ifelse(product_code == 'x', 1, 0),product_tablet = ifelse(product_code == 'q', 1, 0))

# Submit the project 
write.csv(newcompdata,file.path(data_dir,"refine_clean.csv"))


